<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Phone Cat Valentine</title>

  <style>
    :root{
      --bg:#07070c;
      --panel: rgba(18,18,28,.62);
      --stroke: rgba(255,255,255,.12);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.72);
      --blue: rgba(120,200,255,.22);
      --pink:#ff3d86;
      --pink2:#ff86b6;
      --shadow: 0 24px 80px rgba(0,0,0,.55);
      --shadow2: 0 14px 34px rgba(0,0,0,.40);
      --r: 26px;
    }

    *{ box-sizing:border-box; }
    html, body { height:100%; }
    body{
      margin:0;
      background: var(--bg);
      color: var(--text);
      font-family: ui-rounded, system-ui, -apple-system, "Segoe UI", sans-serif;
      overflow:hidden;
    }

    /* ====== Clean animated background (subtle + moving) ====== */
    .bgWrap{ position:fixed; inset:0; overflow:hidden; z-index:0; }
    .bgGlow{
      position:absolute; inset:-20%;
      background:
        radial-gradient(900px 520px at 45% 15%, rgba(120,200,255,.12), transparent 60%),
        radial-gradient(800px 520px at 12% 75%, rgba(255,61,134,.10), transparent 62%),
        radial-gradient(700px 500px at 88% 75%, rgba(255,255,255,.06), transparent 60%);
      animation: drift 14s ease-in-out infinite alternate;
      transform: translateZ(0);
    }
    @keyframes drift{
      from{ transform: translate3d(-1.2%, -0.8%, 0) scale(1.03); }
      to  { transform: translate3d( 1.2%,  0.8%, 0) scale(1.03); }
    }

    .bgPattern{
      position:absolute; inset:-30%;
      opacity:.20;
      background-image:
        radial-gradient(circle at 25% 25%, rgba(255,255,255,.09) 0 2px, transparent 3px),
        radial-gradient(circle at 75% 60%, rgba(255,255,255,.08) 0 2px, transparent 3px),
        radial-gradient(circle at 55% 80%, rgba(255,255,255,.06) 0 2px, transparent 3px);
      background-size: 60px 60px, 90px 90px, 120px 120px;
      animation: patternMove 18s linear infinite;
      transform: translateZ(0);
    }
    @keyframes patternMove{
      to{ transform: translate3d(6%, -4%, 0); }
    }

    /* floating cute icons generated by JS */
    .floaty{
      position:fixed;
      left:0;
      top:0;
      pointer-events:none;
      z-index:1;
      opacity:.9;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.35));
      animation: floatUp linear forwards;
      transform: translateZ(0);
    }
    @keyframes floatUp{
      to{
        transform: translateY(-120vh) translateX(var(--drift)) rotate(360deg);
        opacity:0;
      }
    }

    /* subtle grain */
    .grain{
      position:fixed; inset:-40%;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='220' height='220' filter='url(%23n)' opacity='.12'/%3E%3C/svg%3E");
      mix-blend-mode: soft-light;
      opacity:.16;
      pointer-events:none;
      transform: rotate(7deg);
      z-index:2;
    }

    /* ====== Main Layout ====== */
    .wrap{
      position:relative;
      z-index:5;
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 22px;
    }

    .card{
      width:min(980px, 96vw);
      border-radius: var(--r);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      overflow:hidden;
      transform-style: preserve-3d;
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding: 16px 18px;
      background: rgba(255,255,255,.04);
      border-bottom: 1px solid var(--stroke);
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      font-weight: 950;
      letter-spacing:.3px;
    }
    .pill{
      font-size: 12px;
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(120,200,255,.10);
      border: 1px solid rgba(120,200,255,.18);
      color: rgba(210,240,255,.95);
      white-space:nowrap;
    }
    .status{
      display:flex; align-items:center; gap:10px;
      font-weight: 850;
      font-size: 13px;
      color: var(--muted);
    }
    .dot{
      width:10px; height:10px; border-radius:999px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.95), rgba(120,200,255,.75));
      box-shadow: 0 0 0 6px rgba(120,200,255,.10);
    }

    .musicBtn{
      border:none;
      cursor:pointer;
      border-radius: 999px;
      padding: 8px 10px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.14);
      color: rgba(255,255,255,.92);
      font-weight: 950;
    }

    .content{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap: 14px;
      padding: 16px;
    }
    @media (max-width: 860px){
      .content{ grid-template-columns: 1fr; }
    }

    .panel{
      border-radius: 22px;
      background: var(--panel);
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow2);
      padding: 16px;
      position:relative;
      overflow:hidden;
    }

    .title{
      font-size: clamp(30px, 4.8vw, 52px);
      margin: 6px 0 8px;
      letter-spacing:.2px;
      line-height:1.02;
      background: linear-gradient(135deg, rgba(255,255,255,.94), rgba(255,255,255,.72));
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
      text-shadow: 0 0 20px rgba(120,200,255,.16);
    }
    .subtitle{
      margin: 0 0 14px;
      color: var(--muted);
      font-weight: 650;
    }

    /* Cat character block */
    .catBox{
      display:grid;
      grid-template-columns: 150px 1fr;
      gap: 12px;
      align-items:center;
      margin-top: 10px;
      padding: 12px;
      border-radius: 20px;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.10);
    }
    @media (max-width: 520px){
      .catBox{ grid-template-columns: 1fr; }
    }

    .catPic{
      width: 150px; height: 150px;
      border-radius: 22px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: 0 18px 40px rgba(0,0,0,.45);
      position:relative;
      background: rgba(255,255,255,.04);
      display:flex;
      align-items:center;
      justify-content:center;
    }

    /* phone-glow overlay */
    .catPic:after{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(220px 220px at 55% 60%, rgba(120,200,255,.24), transparent 60%);
      mix-blend-mode: screen;
      pointer-events:none;
    }

    .bubble{
      position:relative;
      padding: 12px 12px;
      border-radius: 18px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.92);
      box-shadow: 0 12px 26px rgba(0,0,0,.35);
      font-weight: 850;
      line-height:1.25;
    }
    .bubble small{
      display:block;
      margin-top: 8px;
      opacity:.85;
      font-weight: 900;
      color: rgba(210,240,255,.95);
    }

    /* Photo stage (one photo only) */
    .photoStage{
      border-radius: 22px;
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.12);
      overflow:hidden;
      box-shadow: 0 18px 50px rgba(0,0,0,.45);
      position:relative;
    }
    .photoStage img{
      width:100%;
      height: 390px;
      object-fit:cover;
      display:block;
      filter: saturate(1.08) contrast(1.04);
    }
    @media (max-width: 860px){
      .photoStage img{ height: 320px; }
    }
    .photoHUD{
      position:absolute;
      left:12px; right:12px; bottom:12px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      pointer-events:none;
    }
    .tag{
      font-weight: 950;
      font-size: 12px;
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.45);
      border: 1px solid rgba(255,255,255,.14);
      color: rgba(255,255,255,.9);
      backdrop-filter: blur(8px);
    }
    .progress{
      font-weight: 950;
      font-size: 12px;
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.45);
      border: 1px solid rgba(255,255,255,.14);
      color: rgba(210,240,255,.95);
      backdrop-filter: blur(8px);
    }

    /* Buttons */
    .ctaRow{
      margin-top: 14px;
      min-height: 96px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap: 12px;
      position:relative;
    }
    button{
      border:none;
      cursor:pointer;
      border-radius: 999px;
      padding: 12px 20px;
      font-weight: 1000;
      letter-spacing:.2px;
      box-shadow: 0 18px 40px rgba(0,0,0,.40);
      transition: transform .12s ease, filter .12s ease;
      user-select:none;
      touch-action: manipulation;
      position:relative;
      overflow:hidden;
    }
    #yesBtn{
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      color:white;
      font-size: 22px;
      transform-origin:center;
    }
    #yesBtn:hover{ transform: translateY(-2px) scale(1.02); }

    #noBtn{
      background: rgba(160,160,175,.18);
      border: 1px solid rgba(255,255,255,.14);
      color: rgba(255,255,255,.92);
      font-size: 18px;
      backdrop-filter: blur(10px);
    }
    #noBtn.wiggle{ animation: wiggle .25s ease-in-out 1; }
    @keyframes wiggle{
      0%{ transform: rotate(0deg) translateY(0); }
      25%{ transform: rotate(-6deg) translateY(-1px); }
      50%{ transform: rotate(6deg) translateY(1px); }
      75%{ transform: rotate(-5deg) translateY(0); }
      100%{ transform: rotate(0deg) translateY(0); }
    }

    .helper{
      margin-top: 8px;
      text-align:center;
      font-size: 13px;
      color: rgba(255,255,255,.72);
      font-weight: 800;
    }

    /* Success */
    .success{
      padding: 20px 16px;
      text-align:center;
    }
    .success h1{
      margin: 0 0 8px;
      font-size: clamp(34px, 5vw, 58px);
      background: linear-gradient(135deg, #fff, rgba(210,240,255,.92));
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
    }
    .success p{
      margin: 0 0 16px;
      color: rgba(255,255,255,.84);
      font-weight: 750;
    }
    .success img{
      width: min(520px, 92vw);
      height: 320px;
      object-fit:cover;
      border-radius: 22px;
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: 0 20px 60px rgba(0,0,0,.55);
      display:block;
      margin: 0 auto;
    }

    /* tiny hint */
    .hint{
      margin-top: 10px;
      font-size: 12px;
      color: rgba(255,255,255,.58);
      text-align:center;
      font-weight: 800;
    }
  </style>
</head>

<body>
  <div class="bgWrap">
    <div class="bgGlow"></div>
    <div class="bgPattern"></div>
  </div>
  <div class="grain"></div>

  <div class="wrap">
    <div class="card" id="card">
      <div class="topbar">
        <div class="brand">
          <div class="pill">üòº PHONE CAT MODE</div>
          <div>Valentine Request</div>
        </div>

        <div class="status">
          <span class="dot"></span>
          <span id="statusText">Phone Cat is online‚Ä¶</span>
          <button class="musicBtn" id="musicToggle" title="Toggle music">üîá</button>
        </div>
      </div>

      <div class="content">
        <!-- LEFT -->
        <div class="panel" id="leftPanel">
          <div class="title">Will you be my Valentine? üíñ</div>
          <div class="subtitle">
            Each time you press <b>No</b>, the chonky cat changes mood and a new couple photo unlocks.
          </div>

          <div class="catBox" id="catBox">
            <div class="catPic">
              <div id="catSvg"></div>
            </div>
            <div class="bubble" id="bubble">
              *aggressive scrolling* ‚Ä¶ choose wisely. üëÅÔ∏èüì±
              <small id="bubbleTag">Tip: ‚ÄúNo‚Äù buffs the YES button.</small>
            </div>
          </div>

          <div class="ctaRow" id="ctaRow">
            <button id="yesBtn">YES üíï</button>
            <button id="noBtn">No üòø</button>
          </div>

          <div class="helper" id="helperText">
            Rejections: <span id="rejCount">0</span> ‚Ä¢ Photos revealed: <span id="photoCount">1</span>/8 ‚Ä¢ Mood: <span id="moodText">Piano</span>
          </div>

          <div class="hint">Music starts on first click (browser rule). Use üîá/üîä to toggle.</div>
        </div>

        <!-- RIGHT -->
        <div class="panel" id="rightPanel">
          <div style="font-weight:950; margin: 2px 0 10px; color: rgba(210,240,255,.95);">
            üì∏ Memory Reveal (one per rejection)
          </div>

          <div class="photoStage">
            <img id="stageImg" src="us1.jpg" alt="couple photo">
            <div class="photoHUD">
              <div class="tag" id="tagText">Unlocked photo #1</div>
              <div class="progress" id="progressText">Next unlock: click ‚ÄúNo‚Äù üòº</div>
            </div>
          </div>

          <div style="margin-top:10px; color: rgba(255,255,255,.68); font-weight:800; font-size:13px;">
            (Pressing ‚ÄúNo‚Äù reveals more. Pressing ‚ÄúYes‚Äù ends Phone Cat‚Äôs villain arc.)
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ====== IMPORTANT: Put these files in the same folder as this HTML ======
    // us1.jpg ... us8.jpg (your couple photos)
    const OUR_PHOTOS = ["us1.jpg","us2.jpg","us3.jpg","us4.jpg","us5.jpg","us6.jpg","us7.jpg","us8.jpg"];

    // ====== UI refs ======
    const statusText = document.getElementById("statusText");
    const bubble = document.getElementById("bubble");
    const bubbleTag = document.getElementById("bubbleTag");
    const yesBtn = document.getElementById("yesBtn");
    const noBtn = document.getElementById("noBtn");
    const ctaRow = document.getElementById("ctaRow");

    const stageImg = document.getElementById("stageImg");
    const tagText = document.getElementById("tagText");
    const progressText = document.getElementById("progressText");

    const rejCountEl = document.getElementById("rejCount");
    const photoCountEl = document.getElementById("photoCount");
    const moodTextEl = document.getElementById("moodText");

    const musicToggle = document.getElementById("musicToggle");

    // ====== State ======
    let noCount = 0;
    let photoIndex = 0;
    let yesFont = 22;

    // ====== Floating background icons ======
    function spawnFloaty(){
      const el = document.createElement("div");
      el.className = "floaty";
      el.textContent = Math.random() > 0.6 ? "üêæ" : (Math.random() > 0.5 ? "üíñ" : "üíï");
      el.style.left = (Math.random() * 100) + "vw";
      el.style.top = (100 + Math.random() * 20) + "vh";
      el.style.fontSize = (14 + Math.random() * 22) + "px";
      el.style.animationDuration = (7 + Math.random() * 6) + "s";
      el.style.setProperty("--drift", (Math.random() * 160 - 80) + "px");
      document.body.appendChild(el);
      setTimeout(()=> el.remove(), 13000);
    }
    setInterval(spawnFloaty, 520);

    // ====== NO button runs away ======
    function moveNoButton(){
      const area = ctaRow.getBoundingClientRect();
      const btn = noBtn.getBoundingClientRect();
      const maxX = Math.max(0, area.width - btn.width);
      const maxY = Math.max(0, area.height - btn.height);
      const x = Math.random() * maxX;
      const y = Math.random() * maxY;
      noBtn.style.position = "absolute";
      noBtn.style.left = x + "px";
      noBtn.style.top = y + "px";
    }

    function updateCounts(){
      rejCountEl.textContent = String(noCount);
      photoCountEl.textContent = String(photoIndex + 1);
    }
    updateCounts();

    function setPhoto(i){
      stageImg.src = OUR_PHOTOS[i];
      tagText.textContent = `Unlocked photo #${i+1}`;
      progressText.textContent = (i < OUR_PHOTOS.length - 1)
        ? `Next unlock: click ‚ÄúNo‚Äù üòº`
        : `All photos unlocked. Now press YES. üòΩ`;
    }

    // ====== Chonky cat (inline SVG so it never goes blank) ======
    const catSvg = document.getElementById("catSvg");

    const CAT_EXPRESSIONS = [
      { eyes:"wide",  mouth:"smile", blush:true  },
      { eyes:"wide",  mouth:"flat",  blush:false },
      { eyes:"squint",mouth:"smile", blush:true  },
      { eyes:"squint",mouth:"flat",  blush:false },
      { eyes:"angry", mouth:"flat",  blush:true  },
      { eyes:"wide",  mouth:"owo",   blush:true  },
      { eyes:"squint",mouth:"owo",   blush:false },
      { eyes:"wide",  mouth:"smile", blush:true  },
    ];

    function renderCat(exprIndex){
      const e = CAT_EXPRESSIONS[exprIndex % CAT_EXPRESSIONS.length];

      const eye = (x) => {
        if (e.eyes === "wide")   return `<circle cx="${x}" cy="78" r="7" fill="#12121c"/><circle cx="${x+2}" cy="76" r="2" fill="#fff"/>`;
        if (e.eyes === "squint") return `<path d="M${x-8} 78 Q ${x} 72 ${x+8} 78" stroke="#12121c" stroke-width="4" stroke-linecap="round" fill="none"/>`;
        return `
          <path d="M${x-10} 72 Q ${x} 66 ${x+10} 72" stroke="#12121c" stroke-width="4" stroke-linecap="round" fill="none"/>
          <circle cx="${x}" cy="80" r="5.5" fill="#12121c"/>
          <circle cx="${x+2}" cy="78" r="1.8" fill="#fff"/>
        `;
      };

      let mouth = "";
      if (e.mouth === "smile") mouth = `<path d="M92 98 Q 110 114 128 98" stroke="#12121c" stroke-width="4" stroke-linecap="round" fill="none"/>`;
      if (e.mouth === "flat")  mouth = `<path d="M94 104 Q 110 104 126 104" stroke="#12121c" stroke-width="4" stroke-linecap="round" fill="none"/>`;
      if (e.mouth === "owo")   mouth = `<circle cx="110" cy="104" r="7" fill="none" stroke="#12121c" stroke-width="4"/>`;

      catSvg.innerHTML = `
        <svg viewBox="0 0 220 220" width="150" height="150" style="display:block">
          <defs>
            <linearGradient id="fur" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#ffe8d8"/>
              <stop offset="1" stop-color="#ffd2c6"/>
            </linearGradient>
            <linearGradient id="ear" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#ffbfd3"/>
              <stop offset="1" stop-color="#ff9ec2"/>
            </linearGradient>
          </defs>

          <!-- phone glow -->
          <circle cx="110" cy="160" r="70" fill="rgba(120,200,255,.10)"/>
          <circle cx="110" cy="160" r="48" fill="rgba(120,200,255,.14)"/>

          <!-- tail -->
          <path d="M170 155c28 2 36 28 18 38-16 9-34-2-37-16" fill="none" stroke="#ffb3c8" stroke-width="12" stroke-linecap="round"/>

          <!-- body -->
          <ellipse cx="110" cy="140" rx="78" ry="62" fill="url(#fur)" stroke="rgba(255,255,255,.55)" stroke-width="4"/>
          <ellipse cx="110" cy="155" rx="48" ry="35" fill="#fff6f3" opacity=".92"/>

          <!-- head -->
          <circle cx="110" cy="85" r="54" fill="url(#fur)" stroke="rgba(255,255,255,.55)" stroke-width="4"/>

          <!-- ears -->
          <path d="M70 55 L58 22 L88 40 Z" fill="url(#fur)" stroke="rgba(255,255,255,.5)" stroke-width="3"/>
          <path d="M150 55 L162 22 L132 40 Z" fill="url(#fur)" stroke="rgba(255,255,255,.5)" stroke-width="3"/>
          <path d="M73 52 L64 30 L85 42 Z" fill="url(#ear)" opacity=".92"/>
          <path d="M147 52 L156 30 L135 42 Z" fill="url(#ear)" opacity=".92"/>

          <!-- eyes -->
          ${eye(92)}
          ${eye(128)}

          <!-- cheeks -->
          ${e.blush ? `<circle cx="78" cy="102" r="9" fill="#ff9ec2" opacity=".35"/><circle cx="142" cy="102" r="9" fill="#ff9ec2" opacity=".35"/>` : ``}

          <!-- nose -->
          <path d="M110 98c-8 0-12-6-8-10 6-6 10-6 16 0 4 4 0 10-8 10z" fill="#ff7aa8" opacity=".85"/>

          <!-- mouth -->
          ${mouth}

          <!-- paws -->
          <ellipse cx="78" cy="182" rx="22" ry="16" fill="#fff6f3"/>
          <ellipse cx="142" cy="182" rx="22" ry="16" fill="#fff6f3"/>
        </svg>
      `;
    }
    renderCat(0);

    // ====== Phone-cat commentary ======
    const CAT_LINES = [
      ["I‚Äôm online. I‚Äôm watching. üëÅÔ∏èüì±", "Music starts after the first click."],
      ["You clicked No. That‚Äôs wild. üòæ", "New photo unlocked. I‚Äôm still judging."],
      ["This is getting personal. üòº", "YES button is now in training."],
      ["I‚Äôm not mad. I‚Äôm just‚Ä¶ scrolling. üôÄ", "Another photo unlocked. Please behave."],
      ["Okay we‚Äôre switching to jazz now. üé∑", "Because the drama level is rising."],
      ["Stop clicking No like it‚Äôs a hobby üò≠", "I‚Äôm running out of patience (and snacks)."],
      ["Final warning: press YES and I purr. üòΩ", "Choose love. Choose peace."],
      ["Evidence reviewed. Verdict: YES. ‚úÖ", "Case closed. Valentine secured."]
    ];

    function phoneCatTalk(i){
      const line = CAT_LINES[i % CAT_LINES.length];
      bubble.childNodes[0].textContent = line[0] + " ";
      bubbleTag.textContent = line[1];
      statusText.textContent = `Rejections: ${noCount} ‚Ä¢ Phone Cat mood: ${i < 2 ? "concerned" : i < 5 ? "judging" : "tired"}`;
    }
    phoneCatTalk(0);

    // ====== Soft background music (original + mood-based) ======
    // Piano first, jazz after 4 rejections.
    let audioCtx, masterGain, musicOn = false, musicMode = "piano";
    let timerId = null;

    function startMusic(mode="piano"){
      if (musicOn) return;
      musicOn = true;
      musicMode = mode;
      moodTextEl.textContent = (musicMode === "piano") ? "Piano" : "Jazz";

      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      masterGain = audioCtx.createGain();
      masterGain.gain.value = 0.26;
      masterGain.connect(audioCtx.destination);

      function playNote(freq, t, dur, type="sine", gain=0.09){
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = type;
        o.frequency.setValueAtTime(freq, t);
        g.gain.setValueAtTime(0.0001, t);
        g.gain.exponentialRampToValueAtTime(gain, t + 0.01);
        g.gain.exponentialRampToValueAtTime(0.0001, t + dur);
        o.connect(g); g.connect(masterGain);
        o.start(t); o.stop(t + dur + 0.03);
      }

      const A4 = 440;
      const note = (n) => A4 * Math.pow(2, n/12); // semitones from A4

      const pianoChords = [
        [note(-9), note(-5), note(-2)],   // C-ish
        [note(-7), note(-4), note(0)],    // Dm-ish
        [note(-5), note(-2), note(2)],    // Em-ish
        [note(-4), note(0),  note(3)],    // F-ish
      ];

      const jazzChords = [
        [note(-9), note(-3), note(0), note(4)],  // Cmaj7-ish
        [note(-7), note(-1), note(2), note(5)],  // Dm7-ish
        [note(-5), note(1),  note(4), note(7)],  // Em7-ish
        [note(-4), note(2),  note(5), note(9)],  // Fmaj7-ish
      ];

      let step = 0;
      const tempo = 76; // slow & romantic
      const beat = 60/tempo;

      function schedule(){
        const now = audioCtx.currentTime + 0.05;
        const chords = (musicMode === "jazz") ? jazzChords : pianoChords;
        const chord = chords[step % chords.length];

        if (musicMode === "piano"){
          // warm chord + gentle arpeggio
          chord.forEach((f)=> playNote(f, now, 1.55, "sine", 0.07));
          playNote(chord[0]*2, now + beat*0.5, 0.65, "triangle", 0.05);
          playNote(chord[1]*2, now + beat*1.0, 0.65, "triangle", 0.05);
          playNote(chord[2]*2, now + beat*1.5, 0.65, "triangle", 0.05);
        } else {
          // jazzy comp + light bass
          playNote(chord[0], now, 0.30, "triangle", 0.055);
          playNote(chord[0], now + beat*2, 0.30, "triangle", 0.055);

          chord.forEach(f => playNote(f*2, now + beat*1.0, 0.32, "sine", 0.042));
          chord.forEach(f => playNote(f*2, now + beat*3.0, 0.32, "sine", 0.042));
        }

        step++;
      }

      schedule();
      timerId = setInterval(schedule, 4 * beat * 1000);
      musicToggle.textContent = "üîä";
    }

    function stopMusic(){
      if (!musicOn) return;
      musicOn = false;
      musicToggle.textContent = "üîá";
      moodTextEl.textContent = "Off";
      if (timerId) clearInterval(timerId);
      timerId = null;
      if (audioCtx) audioCtx.close();
      audioCtx = null;
    }

    function switchMusic(mode){
      musicMode = mode;
      if (musicOn) moodTextEl.textContent = (musicMode === "piano") ? "Piano" : "Jazz";
    }

    // Start music on first click (browser autoplay-safe)
    document.addEventListener("click", () => {
      if (!musicOn) startMusic("piano");
    }, { once: true });

    // Toggle button
    musicToggle.addEventListener("click", (e) => {
      e.stopPropagation();
      if (musicOn) stopMusic();
      else startMusic(musicMode || "piano");
    });

    // ====== Button handlers ======
    noBtn.addEventListener("click", () => {
      noCount++;

      // YES grows
      yesFont += 14;
      yesBtn.style.fontSize = yesFont + "px";
      yesBtn.style.transform = `scale(${1 + noCount*0.035})`;

      // Cat mood changes every rejection
      renderCat(noCount);

      // Reveal next photo (one per rejection)
      if (photoIndex < OUR_PHOTOS.length - 1){
        photoIndex++;
        setPhoto(photoIndex);
      }

      updateCounts();
      phoneCatTalk(noCount);

      // Switch to jazz after 4 rejections
      if (noCount >= 4) switchMusic("jazz");

      // wiggle + run away after 2
      noBtn.classList.remove("wiggle");
      void noBtn.offsetWidth;
      noBtn.classList.add("wiggle");
      if(noCount >= 2) moveNoButton();
      if(noCount >= 6) noBtn.style.transform = "scale(0.85)";
      if(noCount >= 8) noBtn.style.transform = "scale(0.7)";
    });

    yesBtn.addEventListener("click", () => {
      // Keep music, but go back to piano for the happy ending
      switchMusic("piano");

      document.getElementById("leftPanel").innerHTML = `
        <div class="success">
          <h1>YAYYYYY üíñ</h1>
          <p>
            Phone Cat has approved this YES. ‚úÖ<br/>
            You‚Äôre officially my Valentine üòΩü´∂
          </p>
          <img src="${OUR_PHOTOS[Math.min(1, OUR_PHOTOS.length-1)]}" alt="us photo">
          <div style="margin-top:14px; font-weight:950; color: rgba(210,240,255,.95);">
            Date night unlocked üç∞üåπ (and Phone Cat demands snacks)
          </div>
        </div>
      `;

      statusText.textContent = "APPROVED ‚úÖ Phone Cat is purring.";
      // disable No button if still present
      const maybeNo = document.getElementById("noBtn");
      if (maybeNo) maybeNo.disabled = true;
    });

  </script>
</body>
</html>
